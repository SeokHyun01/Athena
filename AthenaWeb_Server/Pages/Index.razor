@page "/"

@inject UserManager<AppUser> _userManager
@inject NavigationManager _navigationManager

@attribute [Authorize(Roles = SD.ROLE_CUSTOMER)]


<!-- Masthead-->
<header class="masthead">
	<div class="container">
        <div class="masthead-subheading">환영합니다!</div>
        <div class="masthead-heading text-uppercase">A I E y e</div>
        <a class="btn btn btn-outline-primary btn-xl" href="camera">시작하기</a>
	</div>
</header>

<!-- Services-->
<section class="page-section" id="services">
    <div class="container">
        <div class="text-center">
            <h2 class="section-heading text-uppercase">졸업작품 설명</h2>
            <h3 class="section-subheading text-muted">위 플랫폼은 아래와 같은 서비스를 제공합니다.</h3>
        </div>
        <div class="row text-center">
            <div class="col-md-4">
                <span class="fa-stack fa-4x">
                    <i class="fas fa-circle fa-stack-2x text-primary"></i>
                    <i class="fas fa-shopping-cart fa-stack-1x fa-inverse"></i>
                </span>
                <h4 class="my-3">객체 인식</h4>
                <p class="text-muted">등록한 기기에서 사용자가 설정한 객체를 인식할 수 있습니다. 현재 움직임, 화재 인식을 지원 중입니다.</p>
            </div>
            <div class="col-md-4">
                <span class="fa-stack fa-4x">
                    <i class="fas fa-circle fa-stack-2x text-primary"></i>
                    <i class="fas fa-laptop fa-stack-1x fa-inverse"></i>
                </span>
                <h4 class="my-3">실시간 모니터링</h4>
                <p class="text-muted">등록한 기기에서 촬영 중인 영상을 실시간으로 확인할 수 있습니다.</p>
            </div>
            <div class="col-md-4">
                <span class="fa-stack fa-4x">
                    <i class="fas fa-circle fa-stack-2x text-primary"></i>
                    <i class="fas fa-lock fa-stack-1x fa-inverse"></i>
                </span>
                <h4 class="my-3">알람</h4>
                <p class="text-muted">등록한 기기에서 이벤트가 감지됐을 때 알람을 받을 수 있습니다.</p>
            </div>
        </div>
    </div>
</section>

<!-- Team-->
<section class="page-section bg-light" id="team">
    <div class="container">
        <div class="text-center">
            <h2 class="section-heading text-uppercase">조 구성</h2>
        </div>
        <div class="row">
            <div class="col-lg-4">
                <div class="team-member">
                    <h4>오지훈</h4>
                    <p class="text-muted">하드웨어 개발</p>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand Twitter Profile"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand Facebook Profile"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand LinkedIn Profile"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="team-member">
                    <h4>윤석현</h4>
                    <p class="text-muted">웹 개발</p>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Diana Petersen Twitter Profile"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Diana Petersen Facebook Profile"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Diana Petersen LinkedIn Profile"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="team-member">
                    <h4>최승준</h4>
                    <p class="text-muted">웹 및 앱 개발</p>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Larry Parker Twitter Profile"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Larry Parker Facebook Profile"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Larry Parker LinkedIn Profile"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
    </div>
</section>


@code {
	[CascadingParameter]
	public Task<AuthenticationState> _authState { get; set; }


	protected override async Task OnAfterRenderAsync(bool firstRender)
	{
		if (firstRender)
		{
			var authState = await _authState;
			var userName = authState.User.Identity.Name;
			var user = await _userManager.FindByEmailAsync(userName);
			var isAdmin = await _userManager.IsInRoleAsync(user, SD.ROLE_ADMIN);
			if (isAdmin)
			{
				_navigationManager.NavigateTo("admin");
			}
		}
	}
}